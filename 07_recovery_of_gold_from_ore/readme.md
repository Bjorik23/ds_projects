# Восстановление золота из руды

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Необходимо:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

## **Описание данных**

Технологический процесс
- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
   - Xanthate *— ксантогенат (промотер, или активатор флотации);
   - Sulphate — сульфат (на данном производстве сульфид натрия);
   - Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

Параметры этапов
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

Наименование признаков

Наименование признаков должно быть такое:

`[этап].[тип_параметра].[название_параметра]`

Пример: `rougher.input.feed_ag`

Возможные значения для блока `[этап]`:
- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики

Возможные значения для блока `[тип_параметра]:`
- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

# Общие выводы по результатам проекта

В процессе написания проекта создания модели машинного обучения для производства золота сделано следующее:

- Произведено изучение датасета. 
- Произвели проверку значения показателей эффективности обогащения на обучающей выборке для признака rougher.output.recovery. Сравнив с расчетными данными, получили значение MAE практически равное нулю.
- Проведена предобработка датасета в части заполнения пропусков и перевода столбца с датами и временем в индексы.
- Проведен анализ данных: 
    - изменения концентрации металлов (Au, Ag, Pb) на различных этапах очистки. На каждом этапе обработки концентрация золота увеличивается, что говорит о правильно налаженном процессе обработки. Концентрация серебра в процессе обработки снижается, а концентрация свинца наоборот незначительно повышается после флотации на далее остается на одном уровне.
    - сравнили распределение размеров гранул сырья на обучающей и тестовой выборках. Сделали вывод, что распределение значений размера гранул в обучающей и тестовой выборках отличается незначительно и не должно повлиять на оценку модели.
    - исследовали суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах. 
    - в процессе анализа использовали гистограммы, диаграммы размаха, диаграммы разброса.
    - удалены аномальные значения в данных концентрации металлов на разных стадиях обработки.
- Данные обучающей и тестовой выборок были разделены на две выборки: обучающую и валидационную. Масштабирование данных не требовалось.
- Создана функция для расчета sMAPE, которая использовалась в качестве основной метрики при выборе параметров моделей  дерева решений и случайного леса
- Обучены и подобраны параметры моделей линейной регрессии, дерева решений и случайного леса. Сравнили метрику sMAPE у моделей. Лучшей оказалась модель линейной регрессии.
- Модели линейной регрессии и случаного леса проверены на тестовой выборке. Получено значение sMAPE у модели случайного леса - 11,48%